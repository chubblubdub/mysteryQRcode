import os
import requests

# Retrieve the GitHub token from the environment variable
token = os.getenv('CHUB_TOKEN')

# Ensure the token is present
if not token:
    raise ValueError("GitHub token not found. Please set the GITHUB_TOKEN environment variable.")

# Your script logic here
# Example API request using the token
def update_config(new_url):
    url = 'https://api.github.com/repos/chubblubdub/mysteryQRcode/contents/redirect-config.json'
    headers = {
        'Authorization': f'token {token}',
        'Accept': 'application/vnd.github.v3+json'
    }
    # Example JSON payload
    payload = {
        'message': 'Update redirect URL',
        'content': 'base64-encoded-content-here',  # Replace with actual base64 content
        'sha': 'sha-of-the-file'  # Replace with actual SHA
    }
    response = requests.put(url, json=payload, headers=headers)
    if response.status_code == 200:
        print('File updated successfully.')
    else:
        print(f'Error: {response.status_code} - {response.text}')

# Example usage
new_url = 'https://example.com'
update_config(new_url)
